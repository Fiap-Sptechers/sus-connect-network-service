    {
        "info": {
            "_postman_id": "sus-connect-network-tests",
            "name": "SUS Connect Network - Automated Tests",
            "description": "Coleção completa de testes automatizados para todos os endpoints da API SUS Connect Network",
            "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
        },
        "variable": [
            {
                "key": "baseUrl",
                "value": "http://localhost:8080",
                "type": "string"
            },
            {
                "key": "adminToken",
                "value": "",
                "type": "string"
            },
            {
                "key": "managerToken",
                "value": "",
                "type": "string"
            },
            {
                "key": "operatorToken",
                "value": "",
                "type": "string"
            },
            {
                "key": "unitId",
                "value": "",
                "type": "string"
            },
            {
                "key": "specialtyId",
                "value": "",
                "type": "string"
            },
            {
                "key": "specialtyName",
                "value": "",
                "type": "string"
            },
            {
                "key": "doctorId",
                "value": "",
                "type": "string"
            },
            {
                "key": "doctorCrm",
                "value": "",
                "type": "string"
            },
            {
                "key": "shiftId",
                "value": "",
                "type": "string"
            },
            {
                "key": "userId",
                "value": "",
                "type": "string"
            },
            {
                "key": "attendanceId",
                "value": "",
                "type": "string"
            },
            {
                "key": "managerCpf",
                "value": "",
                "type": "string"
            },
            {
                "key": "unitCnpj",
                "value": "",
                "type": "string"
            },
            {
                "key": "unitName",
                "value": "",
                "type": "string"
            }
        ],
        "item": [
            {
                "name": "Authentication",
                "item": [
                    {
                        "name": "Login Admin",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has token', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('token');",
                                        "    pm.collectionVariables.set('adminToken', jsonData.token);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"cpfCnpj\": \"admin\",\n    \"password\": \"admin\"\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/auth/login",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "auth",
                                    "login"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Create Manager User",
                        "event": [
                            {
                                "listen": "prerequest",
                                "script": {
                                    "exec": [
                                        "var random = Math.floor(Math.random() * 100000);",
                                        "pm.collectionVariables.set('managerCpf', '12345' + random);",
                                        ""
                                    ],
                                    "type": "text/javascript"
                                }
                            },
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 201', function () {",
                                        "    pm.response.to.have.status(201);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"name\": \"Manager Test {{managerCpf}}\",\n    \"cpfCnpj\": \"{{managerCpf}}\",\n    \"password\": \"manager123\",\n    \"admin\": false\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/auth/users",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "auth",
                                    "users"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Login Manager",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has token', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('token');",
                                        "    pm.collectionVariables.set('managerToken', jsonData.token);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"cpfCnpj\": \"{{managerCpf}}\",\n    \"password\": \"manager123\"\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/auth/login",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "auth",
                                    "login"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Refresh Token",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has new token', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('token');",
                                        "    pm.collectionVariables.set('adminToken', jsonData.token);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/auth/refresh",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "auth",
                                    "refresh"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Create Admin User (Should Fail - Non-Admin)",
                        "event": [
                            {
                                "listen": "prerequest",
                                "script": {
                                    "exec": [
                                        "var random = Math.floor(Math.random() * 100000);",
                                        "pm.collectionVariables.set('failAdminCpf', '99999' + random);",
                                        ""
                                    ],
                                    "type": "text/javascript"
                                }
                            },
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 403', function () {",
                                        "    pm.response.to.have.status(403);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{managerToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"name\": \"Another Admin\",\n    \"cpfCnpj\": \"{{failAdminCpf}}\",\n    \"password\": \"admin123\",\n    \"admin\": true\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/auth/users",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "auth",
                                    "users"
                                ]
                            }
                        }
                    }
                ]
            },
            {
                "name": "Specialties",
                "item": [
                    {
                        "name": "List Specialties",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response is array', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.be.an('array');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/specialties",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "specialties"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Create Specialty",
                        "event": [
                            {
                                "listen": "prerequest",
                                "script": {
                                    "exec": [
                                        "var random = Math.floor(Math.random() * 100000);",
                                        "pm.collectionVariables.set('specialtyName', 'SPEC_' + random);",
                                        ""
                                    ],
                                    "type": "text/javascript"
                                }
                            },
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 201', function () {",
                                        "    pm.response.to.have.status(201);",
                                        "});",
                                        "",
                                        "pm.test('Response has id', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.collectionVariables.set('specialtyId', jsonData.id);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"name\": \"{{specialtyName}}\"\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/specialties",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "specialties"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Get Specialty By ID",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has correct structure', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.expect(jsonData).to.have.property('name');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/specialties/{{specialtyId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "specialties",
                                    "{{specialtyId}}"
                                ]
                            }
                        }
                    }
                ]
            },
            {
                "name": "Health Units",
                "item": [
                    {
                        "name": "Create Health Unit",
                        "event": [
                            {
                                "listen": "prerequest",
                                "script": {
                                    "exec": [
                                        "var random = Math.floor(Math.random() * 100000000);",
                                        "pm.collectionVariables.set('unitCnpj', '123456' + random);",
                                        "pm.collectionVariables.set('unitName', 'UBS ' + random);",
                                        ""
                                    ],
                                    "type": "text/javascript"
                                }
                            },
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 201', function () {",
                                        "    pm.response.to.have.status(201);",
                                        "});",
                                        "",
                                        "pm.test('Response has id', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.collectionVariables.set('unitId', jsonData.id);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"name\": \"{{unitName}}\",\n    \"cnpj\": \"{{unitCnpj}}\",\n    \"address\": {\n        \"street\": \"Rua Teste\",\n        \"number\": \"123\",\n        \"neighborhood\": \"Centro\",\n        \"city\": \"São Paulo\",\n        \"state\": \"SP\",\n        \"zipCode\": \"01310-100\"\n    },\n    \"contacts\": [\n        {\n            \"type\": \"PHONE\",\n            \"value\": \"11987654321\"\n        }\n    ]\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/units",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units"
                                ]
                            }
                        }
                    },
                    {
                        "name": "List Health Units",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has pagination', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('content');",
                                        "    pm.expect(jsonData).to.have.property('totalElements');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/units",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Get Health Unit By ID",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has correct structure', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.expect(jsonData).to.have.property('name');",
                                        "    pm.expect(jsonData).to.have.property('address');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/units/{{unitId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "{{unitId}}"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Get Health Unit Status",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has status info', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.expect(jsonData).to.have.property('activeShifts');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [],
                            "url": {
                                "raw": "{{baseUrl}}/units/{{unitId}}/status",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "{{unitId}}",
                                    "status"
                                ]
                            }
                        }
                    },
                    {
                        "name": "List Nearby Units",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [],
                            "url": {
                                "raw": "{{baseUrl}}/units/nearby?latitude=-23.5505&longitude=-46.6333&radius=10",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "nearby"
                                ],
                                "query": [
                                    {
                                        "key": "latitude",
                                        "value": "-23.5505"
                                    },
                                    {
                                        "key": "longitude",
                                        "value": "-46.6333"
                                    },
                                    {
                                        "key": "radius",
                                        "value": "10"
                                    }
                                ]
                            }
                        }
                    }
                ]
            },
            {
                "name": "Doctors",
                "item": [
                    {
                        "name": "Create Doctor",
                        "event": [
                            {
                                "listen": "prerequest",
                                "script": {
                                    "exec": [
                                        "var random = Math.floor(Math.random() * 100000);",
                                        "var crmNumber = ('000000' + random).slice(-6);",
                                        "pm.collectionVariables.set('doctorCrm', 'CRM/SP ' + crmNumber);",
                                        ""
                                    ],
                                    "type": "text/javascript"
                                }
                            },
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 201', function () {",
                                        "    pm.response.to.have.status(201);",
                                        "});",
                                        "",
                                        "pm.test('Response has id', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.collectionVariables.set('doctorId', jsonData.id);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"name\": \"Dr. Teste Automacao\",\n    \"crm\": \"{{doctorCrm}}\",\n    \"specialtyIds\": [\"{{specialtyId}}\"]\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/doctors",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "doctors"
                                ]
                            }
                        }
                    },
                    {
                        "name": "List Doctors",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200 or 204', function () {",
                                        "    pm.expect(pm.response.code).to.be.oneOf([200, 204]);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/doctors",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "doctors"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Get Doctor By ID",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has correct structure', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.expect(jsonData).to.have.property('name');",
                                        "    pm.expect(jsonData).to.have.property('crm');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/doctors/{{doctorId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "doctors",
                                    "{{doctorId}}"
                                ]
                            }
                        }
                    }
                ]
            },
            {
                "name": "Shifts",
                "item": [
                    {
                        "name": "Define Shift Schedule",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 201', function () {",
                                        "    pm.response.to.have.status(201);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"unitId\": \"{{unitId}}\",\n    \"specialty\": \"{{specialtyName}}\",\n    \"doctorCrms\": [\"{{doctorCrm}}\"]\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/shifts/schedule",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "shifts",
                                    "schedule"
                                ]
                            }
                        }
                    },
                    {
                        "name": "List Shifts",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200 or 204', function () {",
                                        "    pm.expect(pm.response.code).to.be.oneOf([200, 204]);",
                                        "});",
                                        "",
                                        "if (pm.response.code === 200) {",
                                        "    pm.test('Response has pagination', function () {",
                                        "        var jsonData = pm.response.json();",
                                        "        pm.expect(jsonData).to.have.property('content');",
                                        "        if (jsonData.content.length > 0) {",
                                        "            pm.collectionVariables.set('shiftId', jsonData.content[0].id);",
                                        "        }",
                                        "    });",
                                        "}"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/shifts?unitId={{unitId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "shifts"
                                ],
                                "query": [
                                    {
                                        "key": "unitId",
                                        "value": "{{unitId}}"
                                    }
                                ]
                            }
                        }
                    },
                    {
                        "name": "Update Shift",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "PUT",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"unitId\": \"{{unitId}}\",\n    \"specialty\": \"{{specialtyName}}\",\n    \"capacity\": 15\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/shifts",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "shifts"
                                ]
                            }
                        }
                    }
                ]
            },
            {
                "name": "Users",
                "item": [
                    {
                        "name": "List Users",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response is array', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.be.an('array');",
                                        "    // Find the user created in this run",
                                        "    var managerCpf = pm.collectionVariables.get('managerCpf');",
                                        "    var foundUser = jsonData.find(u => u.cpfCnpj === managerCpf);",
                                        "    if (foundUser) {",
                                        "        pm.collectionVariables.set('userId', foundUser.id);",
                                        "    } else if (jsonData.length > 0) {",
                                        "        pm.collectionVariables.set('userId', jsonData[0].id);",
                                        "    }",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/users",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "users"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Get User By ID",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has correct structure', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.expect(jsonData).to.have.property('name');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/users/{{userId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "users",
                                    "{{userId}}"
                                ]
                            }
                        }
                    }
                ]
            },
            {
                "name": "Unit Members",
                "item": [
                    {
                        "name": "List Unit Members",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response is array', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.be.an('array');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/units/{{unitId}}/users",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "{{unitId}}",
                                    "users"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Add Member to Unit",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"userId\": \"{{userId}}\",\n    \"roleName\": \"MANAGER\"\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/units/{{unitId}}/users",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "{{unitId}}",
                                    "users"
                                ]
                            }
                        }
                    }
                ]
            },
            {
                "name": "Attendances",
                "item": [
                    {
                        "name": "Start Attendance",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 201', function () {",
                                        "    pm.response.to.have.status(201);",
                                        "});",
                                        "",
                                        "pm.test('Response has id', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.collectionVariables.set('attendanceId', jsonData.id);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "POST",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"patientName\": \"João Silva\",\n    \"patientCpf\": \"12345678900\",\n    \"riskClassification\": \"YELLOW\"\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/units/{{unitId}}/attendances",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "{{unitId}}",
                                    "attendances"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Get Attendance By ID",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});",
                                        "",
                                        "pm.test('Response has correct structure', function () {",
                                        "    var jsonData = pm.response.json();",
                                        "    pm.expect(jsonData).to.have.property('id');",
                                        "    pm.expect(jsonData).to.have.property('status');",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "GET",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/units/{{unitId}}/attendances/{{attendanceId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "{{unitId}}",
                                    "attendances",
                                    "{{attendanceId}}"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Update Attendance Status",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 200', function () {",
                                        "    pm.response.to.have.status(200);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "PATCH",
                            "header": [
                                {
                                    "key": "Content-Type",
                                    "value": "application/json"
                                },
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "body": {
                                "mode": "raw",
                                "raw": "{\n    \"status\": \"IN_PROGRESS\"\n}"
                            },
                            "url": {
                                "raw": "{{baseUrl}}/units/{{unitId}}/attendances/{{attendanceId}}/status",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "{{unitId}}",
                                    "attendances",
                                    "{{attendanceId}}",
                                    "status"
                                ]
                            }
                        }
                    }
                ]
            },
            {
                "name": "Cleanup",
                "item": [
                    {
                        "name": "Delete Shift",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 204', function () {",
                                        "    pm.response.to.have.status(204);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "DELETE",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/shifts/{{shiftId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "shifts",
                                    "{{shiftId}}"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Delete Doctor",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 204', function () {",
                                        "    pm.response.to.have.status(204);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "DELETE",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/doctors/{{doctorId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "doctors",
                                    "{{doctorId}}"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Delete Health Unit",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 204', function () {",
                                        "    pm.response.to.have.status(204);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "DELETE",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/units/{{unitId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "units",
                                    "{{unitId}}"
                                ]
                            }
                        }
                    },
                    {
                        "name": "Delete Specialty",
                        "event": [
                            {
                                "listen": "test",
                                "script": {
                                    "exec": [
                                        "pm.test('Status code is 204', function () {",
                                        "    pm.response.to.have.status(204);",
                                        "});"
                                    ],
                                    "type": "text/javascript"
                                }
                            }
                        ],
                        "request": {
                            "method": "DELETE",
                            "header": [
                                {
                                    "key": "Authorization",
                                    "value": "Bearer {{adminToken}}"
                                }
                            ],
                            "url": {
                                "raw": "{{baseUrl}}/specialties/{{specialtyId}}",
                                "host": [
                                    "{{baseUrl}}"
                                ],
                                "path": [
                                    "specialties",
                                    "{{specialtyId}}"
                                ]
                            }
                        }
                    }
                ]
            }
        ]
    }